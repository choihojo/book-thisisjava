# 1.4 바이트코드 파일과 자바 가상 머신

## 1.4.1 바이트코드 파일

`.java` 소스 파일을 작성한 후에는 컴파일을 해야 한다. `javac` 명령어는 소스 파일을 컴파일하는데, 컴파일 결과는 `.class`인 바이트코드 파일로 생성된다. 바이트코드는 JVM에 의해 실행된다. 생성되는 바이트코드 파일은 OS에 구애받지 않는다. 바이트코드 파일은 자바의 목적 파일이라고 간주할 수 있다.

```
C:\Users\developer\Desktop\root\book\book-thisisjava\src\ch01\sec05>javac -d bin Hello.java
```

## 1.4.2. 자바 가상 머신

`.class` 바이트코드 파일을 OS가 이해하는 기계어로 번역하고 실행시키는 명령어는 `java`이다. `java` 명령어는 JDK와 함께 설치된 JVM을 구동시켜 바이트코드 파일을 완전한 기계어로 번역하고 실행시킨다.

바이트코드 파일은 OS에 구애받지 않고 모두 동일한 내용으로 생성되지만, JVM은 OS에서 이해하는 기계어로 번역해야 하므로 OS별로 다르게 설치된다. 그래서 OS별로 설치하는 JDK가 다르다. 자바는 플랫폼에 독립적이지만 JVM은 플랫폼에 종속적이다.

JVM은 일반적으로 소프트웨어로 작성되지만, 자바 터미널과 같이 하드웨어로 만들어지기도 한다.

```
C:\Users\developer\Desktop\root\book\book-thisisjava\src\ch01\sec05>java -cp bin ch01.sec05.Hello
Hello, Java
```

패키지 구분자는 `.`을 사용해야 하고, 클래스명은 `.class`를 제외한 Hello만 입력해야 한다.

## 1.4.3. 플랫폼 독립성

C나 C++ 같은 경우 컴파일되면 CPU와 OS에 종속적인 기계어로 변환된다. 예를 들어 Intel CPU와 Linux OS에서 컴파일된 기계어 코드는 Intel CPU와 Windows OS가 탑재된 PC에서는 실행되지 않는다. Intel CPU가 아닌 AMD CPU를 사용하더라도 같은 명령에 대해서 변환되는 기계어가 다를 수 있다. 그래서 C, C++ 프로그램의 경우 각 플랫폼에 맞는 기계어 프로그램을 생성해야 한다. 이를 `플랫폼 종속성`이라고 한다.

이에 반해 자바는 `플랫폼 독립성`을 가지도록 설계되었다. 1991년에 SUN Microsystems에서 제임스 고슬링을 필두로 가전제품의 소프트웨어 개발에 적합한 프로그래밍 언어를 개발하기 시작했다. 기존 언어로 작성된 프로그램은 플랫봄 종속적이어서 플랫폼에 따라 소스를 다시 컴파일하거나 아예 프로그램을 새로 작성해야 하는 단점이 있었다. 특히 가전제품은 CPU의 종류를 포함한 하드웨어 플랫폼이 매우 다양했기 때문에 플랫폼에 독립적인 언어가 요구되었다. 그래서 Oak라는 언어가 개발되었다. 그렇지만 Oak는 가전제품 특성상 매우 적은 메모리를 사용해야한다는 조건을 충족하지 못해서 주목받지 못했다.

Oak는 인터넷과 웹이 발전하면서 널리 알려지게 되었다. Oak가 웹용 개발 언어인 HTML의 정적이라는 단점을 보완할 수 있을 것이라 기대하여 Oak를 웹과 융합시킨 결과로 자바가 개발되었다. 자바는 CPU, OS에 구애받지 않고 JVM만 있으면 어떤 PC에서든 동일하게 실행된다.

참고로 C, C++은 컴파일한 목적 파일을 링크시켜 하나의 실행 파일을 만들며, 동일한 플랫폼이라는 가정 하에 실행 파일 하나만 있으면 실행이 가능하다. 이 실행 파일은 CPU가 바로 실행한다.

반대로 자바의 경우 링크 과정이 없으며 JVM이 컴파일된 바이트코드 파일을 실행한다. 자바는 컴파일된 바이트코드 파일들이나 이들을 하나로 압축한 jar 파일 형태로 배포한다.

## 1.4.4 JDK, JRE, Java SE, Java EE, Java ME, Java FX

- JDK: `Java Development Kit`의 약자로 개발자들이 자바로 개발하는 데 사용되는 SDK이다. JDK는 JRE에 개발 도구가 추가된 키트라고 생각하면 된다.

- JRE: `Java Runtime Environment`의 약자로 JVM, 자파 프로그램 실행에 필요한 라이브러리로 구성된 패키지이다.

- Java SE: `Java Standard Edition`의 약자로 가장 기본이 되는 자바 표준 플랫폼이다. 가장 기본적인 클래스 패키지로 구성되어 있고 PC용 애플리케이션, 웹 개발 등에 쓰인다.

- Java EE: `Java Enterprise Edition`의 약자로 대규모 기업용 자바 플랫폼이다. 기업환경을 위한 대규모 솔루션 개발, 텔레매틱스 시스템 개발 등에 쓰인다.

- Java ME: `Java Micro Edition`의 약자로 작은 임베디드 기기를 다룰 때 이용하는 자바 플랫폼이다. 각각의 OS를 가지고 있는 스마트폰이 대중화된 지금은 널리 쓰이지 않는다.

- Java FX: 가볍고 시각적인 GUI를 제공하는 자바 플랫폼이다.

## 1.4.5 JDK 종류

Linux 배포판에 Ubuntu, CentOS, RedHat 등의 계열이 있듯이 JDK도 여러 종류가 존재한다.

이처럼 JDK에 여러 종류가 존재하는 것은 라이센스 때문이다. 자바에 관심이 있다면 자바가 유료화된다는 말을 한번쯤 들어봤을 것이다. 물론 자바라는 프로그래밍 언어 자체는 GPL 라이센스로 무료이다. 그렇다면 어떤 것이 유료화가 된다는 것인지 궁금할 것이다.

자바 프로그램을 실행하기 위해서는 소스 코드를 컴파일하는 개발 도구와 컴파일된 바이트코드 파일을 실행할 JVM이 필요하다. JDK에는 개발 도구와 JVM이 포함되어 있는데, 이 JVM이 유료화가 되는 것이다.

JDK는 크게 `Oracle JDK`와 `OpenJDK`로 나누어진다. 이중 `Oracle JDK`가 유료화 정책을 가지고 있다. 개인이 학습이나 테스트 목적으로 사용하는 건 문제가 없지만 상업 목적으로 사용하는 경우 라이센스 비용을 지불해야 한다. 그렇지만 모든 `Oracle JDK`가 유료인 것은 아니고 `JDK 8u202` 버전까지는 무료로 이용할 수 있다.

예전에는 `OpenJDK`가 `Oracle JDK`에 비해 성능이 떨어지는 문제가 있었는데 현재는 거의 없어졌다. Oracle이 아닌 업체가 `OpenJDK`를 기반으로 JDK를 제작하여 배포하려면 Oracle의 엄격한 TCK 인증을 통과해야 한다. 그래서 `OpenJDK`가 `Oracle JDK`보다 성능이 떨어지는 문제는 해결되었다.

그래서 일반적으로 `OpenJDK`를 쓰면 된다. 하지만 Oracle이 재산권을 보유하고 있는 플러그인을 써야 하는 경우 `OpenJDK`에서는 해당 플러그인이 제공되지 않기 때문에 쓸 수 없는 것을 인지해야 한다.

### 참고

[LINE의 OpenJDK 적용기: 호환성 확인부터 주의 사항까지](https://engineering.linecorp.com/ko/blog/line-open-jdk)
